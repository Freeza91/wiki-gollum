<style>
  .content { 
    background-color: #ccc;
  }
</style>
<main role="main">
<%= link_to "编辑", edit_wiki_path(@wiki.name), 'data-no-turbolink' => false %>
<section class="content" id="wiki">
  <div class="clear-fix">
    <ul class="tab-controlls right clear-fix">
      <li v-repeat="tabControlls" v-on="click: tabControll(this)" class="{{triggerType === $value ? 'active' : ''}}">
        <a v-text="$value"></a> 
      </li>
    </ul>
  </div>
  <div class="tabs">
    <article id="article" class="markdown-body tab-item active" v-html="wiki | marked"></article>
    <div id="commits" class="tab-item">
      <ul>
          <% @wiki.versions.each do |v| %>
            <li>提交时间： <%= v.authored_date %></li>
            <li>提交人姓名：<%= v.author.name %></li>
            <li>提交人邮箱：<%= v.author.email %></li>
            <li>提交信息：<%= v.message %></li>
          <% end %>
      </ul>
    </div>
  </div>
</section>
</main>
<script>
window.onload=function(){
  new Vue({
    el: '#wiki',
    data: {
      wiki: "<%= j @wiki.raw_data.to_s.html_safe %>",
      triggerType: 'article',
      tabControlls: ['article', 'commits']

    },
    filters: {
      marked: marked
    },
    methods: {
      tabControll: function(item) {
        var triggerType = item._raw;
        item.$root._data.triggerType = item._raw;
        $(".tabs .tab-item.active", "#wiki").removeClass("active");
        $('#' + triggerType, "#wiki").addClass("active");
      }
    }
  });
}
</script>
